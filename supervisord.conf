[supervisord]
nodaemon=true
user=root
logfile=/app/logs/supervisord.log
pidfile=/tmp/supervisord.pid

[unix_http_server]
file=/tmp/supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[program:bot]
directory=/app
command=/bin/sh -c "if [ \"$DEV_MODE\" = \"true\" ]; then \
  watchmedo auto-restart --directory=bot --pattern='*.py' --recursive -- python bot/bot.py; \
  else python bot/bot.py; fi"
stdout_logfile=/app/logs/bot.log
stderr_logfile=/app/logs/bot.err.log
autorestart=true
environment=DEV_MODE="%(ENV_DEV_MODE)s"

[program:notifications]
directory=/app
command=/bin/sh -c "if [ \"$DEV_MODE\" = \"true\" ]; then \
  watchmedo auto-restart --directory=bot --pattern='*.py' --recursive -- python bot/notifications.py; \
  else python bot/notifications.py; fi"
stdout_logfile=/app/logs/notifications.log
stderr_logfile=/app/logs/notifications.err.log
autorestart=true
environment=DEV_MODE="%(ENV_DEV_MODE)s"